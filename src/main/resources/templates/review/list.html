<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>게시판 리스트</title>
<link rel="stylesheet" href="/css/header.css" />
<link rel="stylesheet" href="/css/reviewList.css">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
	integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
	crossorigin="anonymous" referrerpolicy="no-referrer" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
<script src="/js/index.js"></script>

<script>
	function search() {
		let searchText = document.getElementById("searchText").value;
		location.href = "/review/list?searchText=" + searchText;
	}

	function translate(lang) {
		// 번역할 코드
		//ReviewList타이틀
		let text1 = document.getElementById("review1").getAttribute("data-original");
		//리류장소들 한꺼번에
		let reviewPlaces = [];
		$("[id='review_place']").each(function() {
			reviewPlaces.push($(this).attr("data-original"));
		});
		
		let reviewTitle = [];
		$("[id='title']").each(function() {
			reviewTitle.push($(this).attr("data-original"));
		});
		

		// ajax 호출 등의 코드 추가
		$.ajax({
			url : "/translate/reviewsList",
			type : "post",
			data : {
				text1 : text1,
				reviewPlaces : reviewPlaces,
				reviewTitle:reviewTitle,
				lang : lang,
			},
			success : function(joined) {
				//성공
				let index=0;
				$("#review1").html("<h2>" + joined[index].translation + "</h2>");
				index++;
				
				var reviewPlaceElements = $("td#review_place");
				reviewPlaceElements.each(function() {
					var reviewPlaceElement = $(this);
					reviewPlaceElement.text(joined[index].translation);
					reviewPlaceElement.attr("data-translation",
					joined[index].translation);
					index++;
					});
				
				
				var reviewTitleElements = $("a#title");
				reviewTitleElements.each(function() {
				    var reviewTitleElement = $(this);
				    reviewTitleElement.text(joined[index].translation);
				    reviewTitleElement.attr("data-translation", joined[index].translation);
				    index++;
				});

				
			},
			error : function(xhr, status, error) {
				console.error('AJAX error:', error);
			}
		});
	}
	$(document).ready(function() {
		$("#translate-en").click(function() {
			translate('en');
		});
		$("#translate-ja").click(function() {
			translate('ja');
		});
		$("#translatezh-CN").click(function() {
			translate('zh-CN');
		});
	});
</script>
</head>
<body>
	<div th:replace="fragments/header :: header"></div>
	<div class="header-container">


		<button id="translate-en">영어 번역하기</button>
		<button id="translate-ja">일본어 번역하기</button>
		<button id="translatezh-CN">중국어 번역하기</button>
		<div id="translation-result"></div>

		<section class="notice">
			<div class="page-title">
				<div id="review1" data-original="Review List"><h2>Review List</h2></div>
			</div>

			<div class="review-container">
				<!-- board seach area -->
				<div id="review-search">
					<div class="search-window">
						<div class="search-wrap">
							<input id="searchText" type="search" name="searchText"
								placeholder="검색어를 입력해주세요.">
							<button type="button" onclick="search()" class="btn search-btn">검색</button>
						</div>
					</div>
				</div>

				<!-- board list area -->

				<table class="review-table">
					<thead>
						<tr class="mainTitle">
							<th scope="col" class="th-num">No</th>
							<th scope="col" class="th-place">Place</th>
							<th scope="col" class="th-title">Title</th>
							<th scope="col" class="th-writer">Writer</th>
							<th scope="col" class="th-date">Date</th>
							<th scope="col" class="th-hit">HIT</th>
						</tr>
					</thead>
					<tbody>
						<tr th:if="${reviews}" th:each="review, reviewsStat: ${reviews}">
							<td class="color" th:text="${reviewsStat.count}"></td>
							<td id="review_place" class="color"
								th:text="${review.review_place}" th:data-original="${review.review_place}"></td>
							<th><a th:text="${review.title}" th:data-original="${review.title}" id="title"
								th:href="@{/review/read(review_id=${review.review_id})}"></a></th>
							<td th:text="${review.member_id}" class="center"></td>
							<td
								th:text="${#temporals.format(review.created_time, 'yyyy-MM-dd')}"></td>
							<td th:text="${review.hit}"></td>
						</tr>
						<tr th:if="${reviews.empty}">
							<td class="color" colspan="6">리뷰가 없습니다.</td>
						</tr>
					</tbody>
				</table>


				<div class="center">
					<input class="input-btn" type="button"
						onclick="location.href='/review/list'" value="목록으로"> <input
						class="input-btn" type="button"
						onclick="location.href='/review/write'" value="글쓰기">
				</div>
			</div>
		</section>

		<p>
		<div id="navigator" class="center">
			<!-- 이전 그룹이 없을 경우 보여주지 않음 -->
			<th:block th:if="${navi.currentPage - navi.pagePerGroup > 0}">
				<a
					th:href="@{/board/list(page=${navi.currentPage - navi.pagePerGroup}, searchText=${searchText})}"><<</a>&nbsp;&nbsp;
    </th:block>
			<!-- 이전 페이지가 없을 경우 보여주지 않음 -->
			<th:block th:if="${navi.currentPage - 1 > 0}">
				<a
					th:href="@{/board/list(page=${navi.currentPage - 1}, searchText=${searchText})}"><</a>&nbsp;&nbsp;
    </th:block>

			<th:block th:if="${navi.endPageGroup ne 0}">
				<th:block
					th:each="counter : ${#numbers.sequence(navi.startPageGroup, navi.endPageGroup)}">
					<a
						th:href="@{/board/list(page=${counter}, searchText=${searchText})}"
						th:text="${counter}"></a>&nbsp;
      </th:block>
			</th:block>

			<!-- 다음 페이지가 없을 경우 보여주지 않음 -->
			<th:block th:if="${navi.currentPage < navi.totalPageCount}">
				<a
					th:href="@{/board/list(page=${navi.currentPage + 1}, searchText=${searchText})}">></a>&nbsp;&nbsp;
    </th:block>
			<!-- 다음 그룹이 없을 경우 보여주지 않음 -->
			<th:block
				th:if="${navi.currentPage + navi.pagePerGroup < navi.totalPageCount}">
				<a
					th:href="@{/board/list(page=${navi.currentPage + navi.pagePerGroup}, searchText=${searchText})}">>></a>
			</th:block>
		</div>
		<p>
	</div>

</body>
</html>